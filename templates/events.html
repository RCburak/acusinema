{% extends "base.html" %}
{% load static %}

{% block title %}Events{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'etkinlikler.css' %}">
{% endblock %}

{% block content %}
    <main class="main-content-wrapper">
        <section class="section">
            <h2 class="heading-secondary">Upcoming Events</h2>
            <div class="events-list">
                {% if upcoming_events %}
                    {% for event in upcoming_events %}
                    <article class="event-card">
                        <div class="event-content">
                            <h3 class="event-title">{{ event.title }}</h3>
                            <div class="event-meta">
                                {# Tarih formatını daha okunaklı yapalım #}
                                <span><i class="icon-time"></i>{{ event.event_date|date:"F j, Y, P" }}</span> {# GÜNCELLENDİ #}
                                <span><i class="icon-location"></i>{{ event.location }}</span>
                            </div>
                            <p class="event-description">{{ event.description|linebreaks }}</p>

                            {# --- REZERVASYON BUTONU EKLENDİ --- #}
                            {% if user.is_authenticated %}
                                <a href="{% url 'create_reservation' event.id %}" class="movie-card__button" style="margin-top: 15px; text-decoration: none; display: inline-block; width: auto; padding: 10px 20px;">
                                    Make a Reservation
                                </a>
                            {% else %}
                                <p style="font-size: 0.9em; color: var(--color-text-subtle); margin-top: 15px;">
                                    You must be <a href="{% url 'account' %}?next={{ request.path }}">logged in</a> to make a reservation.
                                </p>
                            {% endif %}
                            {# --- BUTON SONU --- #}

                        </div>
                    </article>
                    {% endfor %}
                {% else %}
                    <p>There are no upcoming events.</p>
                {% endif %}
            </div>
        </section>

        <hr class="divider">

        <section class="section">
            <h2 class="heading-secondary">Past Events</h2>
            <div class="events-list past-events">
                {% if past_events %}
                    {% for event in past_events %}
                    <article class="event-card">
                       <div class="event-content">
                            <h3 class="event-title">{{ event.title }}</h3>
                            <div class="event-meta">
                                {# Tarih formatını daha okunaklı yapalım #}
                                <span><i class="icon-time"></i>{{ event.event_date|date:"F j, Y, P" }}</span> {# GÜNCELLENDİ #}
                                <span><i class="icon-location"></i>{{ event.location }}</span>
                            </div>
                            <p class="event-description">{{ event.description|linebreaks }}</p>
                        </div>
                    </article>
                    {% endfor %}
                {% else %}
                    <p>There are no completed events yet.</p>
                {% endif %}
            </div>
        </section>
    </main>
{% endblock %}